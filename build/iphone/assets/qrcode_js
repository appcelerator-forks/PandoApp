var qrcode=function(){function e(t,i){if("undefined"==typeof t.length)throw new Error(t.length+"/"+i);var o=function(){for(var e=0;e<t.length&&0==t[e];)e+=1;for(var o=new Array(t.length-e+i),r=0;r<t.length-e;r+=1)o[r]=t[r+e];return o}(),r={};return r.get=function(e){return o[e]},r.getLength=function(){return o.length},r.multiply=function(t){for(var i=new Array(r.getLength()+t.getLength()-1),o=0;o<r.getLength();o+=1)for(var a=0;a<t.getLength();a+=1)i[o+a]^=l.gexp(l.glog(r.get(o))+l.glog(t.get(a)));return e(i,0)},r.mod=function(t){if(r.getLength()-t.getLength()<0)return r;for(var i=l.glog(r.get(0))-l.glog(t.get(0)),o=new Array(r.getLength()),a=0;a<r.getLength();a+=1)o[a]=r.get(a);for(var a=0;a<t.getLength();a+=1)o[a]^=l.gexp(l.glog(t.get(a))+i);return e(o,0).mod(t)},r}var t=function(t,i){var r=236,l=17,c=t,y=o[i],_=null,f=0,g=null,p=new Array,h={},m=function(e,t){f=4*c+17,_=function(e){for(var t=new Array(e),i=0;e>i;i+=1){t[i]=new Array(e);for(var o=0;e>o;o+=1)t[i][o]=null}return t}(f),I(0,0),I(f-7,0),I(0,f-7),v(),w(),k(e,t),c>=7&&b(e),null==g&&(g=E(c,y,p)),C(g,t)},I=function(e,t){for(var i=-1;7>=i;i+=1)if(!(-1>=e+i||e+i>=f))for(var o=-1;7>=o;o+=1)-1>=t+o||t+o>=f||(_[e+i][t+o]=i>=0&&6>=i&&(0==o||6==o)||o>=0&&6>=o&&(0==i||6==i)||i>=2&&4>=i&&o>=2&&4>=o?!0:!1)},T=function(){for(var e=0,t=0,i=0;8>i;i+=1){m(!0,i);var o=a.getLostPoint(h);(0==i||e>o)&&(e=o,t=i)}return t},w=function(){for(var e=8;f-8>e;e+=1)null==_[e][6]&&(_[e][6]=e%2==0);for(var t=8;f-8>t;t+=1)null==_[6][t]&&(_[6][t]=t%2==0)},v=function(){for(var e=a.getPatternPosition(c),t=0;t<e.length;t+=1)for(var i=0;i<e.length;i+=1){var o=e[t],r=e[i];if(null==_[o][r])for(var l=-2;2>=l;l+=1)for(var n=-2;2>=n;n+=1)_[o+l][r+n]=-2==l||2==l||-2==n||2==n||0==l&&0==n?!0:!1}},b=function(e){for(var t=a.getBCHTypeNumber(c),i=0;18>i;i+=1){var o=!e&&1==(t>>i&1);_[Math.floor(i/3)][i%3+f-8-3]=o}for(var i=0;18>i;i+=1){var o=!e&&1==(t>>i&1);_[i%3+f-8-3][Math.floor(i/3)]=o}},k=function(e,t){for(var i=y<<3|t,o=a.getBCHTypeInfo(i),r=0;15>r;r+=1){var l=!e&&1==(o>>r&1);6>r?_[r][8]=l:8>r?_[r+1][8]=l:_[f-15+r][8]=l}for(var r=0;15>r;r+=1){var l=!e&&1==(o>>r&1);8>r?_[8][f-r-1]=l:9>r?_[8][15-r-1+1]=l:_[8][15-r-1]=l}_[f-8][8]=!e},C=function(e,t){for(var i=-1,o=f-1,r=7,l=0,n=a.getMaskFunction(t),s=f-1;s>0;s-=2)for(6==s&&(s-=1);;){for(var d=0;2>d;d+=1)if(null==_[o][s-d]){var c=!1;l<e.length&&(c=1==(e[l]>>>r&1));var y=n(o,s-d);y&&(c=!c),_[o][s-d]=c,r-=1,-1==r&&(l+=1,r=7)}if(o+=i,0>o||o>=f){o-=i,i=-i;break}}},L=function(t,i){for(var o=0,r=0,l=0,n=new Array(i.length),s=new Array(i.length),d=0;d<i.length;d+=1){var c=i[d].dataCount,y=i[d].totalCount-c;r=Math.max(r,c),l=Math.max(l,y),n[d]=new Array(c);for(var _=0;_<n[d].length;_+=1)n[d][_]=255&t.getBuffer()[_+o];o+=c;var f=a.getErrorCorrectPolynomial(y),u=e(n[d],f.getLength()-1),g=u.mod(f);s[d]=new Array(f.getLength()-1);for(var _=0;_<s[d].length;_+=1){var p=_+g.getLength()-s[d].length;s[d][_]=p>=0?g.get(p):0}}for(var h=0,_=0;_<i.length;_+=1)h+=i[_].totalCount;for(var m=new Array(h),I=0,_=0;r>_;_+=1)for(var d=0;d<i.length;d+=1)_<n[d].length&&(m[I]=n[d][_],I+=1);for(var _=0;l>_;_+=1)for(var d=0;d<i.length;d+=1)_<s[d].length&&(m[I]=s[d][_],I+=1);return m},E=function(e,t,i){for(var o=n.getRSBlocks(e,t),d=s(),c=0;c<i.length;c+=1){var y=i[c];d.put(y.getMode(),4),d.put(y.getLength(),a.getLengthInBits(y.getMode(),e)),y.write(d)}for(var _=0,c=0;c<o.length;c+=1)_+=o[c].dataCount;if(d.getLengthInBits()>8*_)throw new Error("code length overflow. ("+d.getLengthInBits()+">"+8*_+")");for(d.getLengthInBits()+4<=8*_&&d.put(0,4);d.getLengthInBits()%8!=0;)d.putBit(!1);for(;;){if(d.getLengthInBits()>=8*_)break;if(d.put(r,8),d.getLengthInBits()>=8*_)break;d.put(l,8)}return L(d,o)};return h.addData=function(e){var t=d(e);p.push(t),g=null},h.isDark=function(e,t){if(0>e||e>=f||0>t||t>=f)throw new Error(e+","+t);return _[e][t]},h.getModuleCount=function(){return f},h.make=function(){m(!1,T())},h.createTableTag=function(e,t){e=e||2,t="undefined"==typeof t?4*e:t;var i="";i+='<table style="',i+=" border-width: 0px; border-style: none;",i+=" border-collapse: collapse;",i+=" padding: 0px; margin: "+t+"px;",i+='">',i+="<tbody>";for(var o=0;o<h.getModuleCount();o+=1){i+="<tr>";for(var r=0;r<h.getModuleCount();r+=1)i+='<td style="',i+=" border-width: 0px; border-style: none;",i+=" border-collapse: collapse;",i+=" padding: 0px; margin: 0px;",i+=" width: "+e+"px;",i+=" height: "+e+"px;",i+=" background-color: ",i+=h.isDark(o,r)?"#000000":"#ffffff",i+=";",i+='"/>';i+="</tr>"}return i+="</tbody>",i+="</table>"},h.createImgTag=function(e,t){e=e||2,t="undefined"==typeof t?4*e:t;var i=h.getModuleCount()*e+2*t,o=t,r=i-t;return u(i,i,function(t,i){if(t>=o&&r>t&&i>=o&&r>i){var a=Math.floor((t-o)/e),l=Math.floor((i-o)/e);return h.isDark(l,a)?0:1}return 1})},h};t.stringToBytes=function(e){for(var t=new Array,i=0;i<e.length;i+=1){var o=e.charCodeAt(i);t.push(255&o)}return t},t.createStringToBytes=function(e,t){var i=function(){for(var i=_(e),o=function(){var e=i.read();if(-1==e)throw new Error;return e},r=0,a={};;){var l=i.read();if(-1==l)break;var n=o(),s=o(),d=o(),c=String.fromCharCode(l<<8|n),y=s<<8|d;a[c]=y,r+=1}if(r!=t)throw new Error(r+" != "+t);return a}(),o="?".charCodeAt(0);return function(e){for(var t=new Array,r=0;r<e.length;r+=1){var a=e.charCodeAt(r);if(128>a)t.push(a);else{var l=i[e.charAt(r)];"number"==typeof l?(255&l)==l?t.push(l):(t.push(l>>>8),t.push(255&l)):t.push(o)}}return t}};var i={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},o={L:1,M:0,Q:3,H:2},r={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},a=function(){var t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],o=1335,a=7973,n=21522,s={},d=function(e){for(var t=0;0!=e;)t+=1,e>>>=1;return t};return s.getBCHTypeInfo=function(e){for(var t=e<<10;d(t)-d(o)>=0;)t^=o<<d(t)-d(o);return(e<<10|t)^n},s.getBCHTypeNumber=function(e){for(var t=e<<12;d(t)-d(a)>=0;)t^=a<<d(t)-d(a);return e<<12|t},s.getPatternPosition=function(e){return t[e-1]},s.getMaskFunction=function(e){switch(e){case r.PATTERN000:return function(e,t){return(e+t)%2==0};case r.PATTERN001:return function(e){return e%2==0};case r.PATTERN010:return function(e,t){return t%3==0};case r.PATTERN011:return function(e,t){return(e+t)%3==0};case r.PATTERN100:return function(e,t){return(Math.floor(e/2)+Math.floor(t/3))%2==0};case r.PATTERN101:return function(e,t){return e*t%2+e*t%3==0};case r.PATTERN110:return function(e,t){return(e*t%2+e*t%3)%2==0};case r.PATTERN111:return function(e,t){return(e*t%3+(e+t)%2)%2==0};default:throw new Error("bad maskPattern:"+e)}},s.getErrorCorrectPolynomial=function(t){for(var i=e([1],0),o=0;t>o;o+=1)i=i.multiply(e([1,l.gexp(o)],0));return i},s.getLengthInBits=function(e,t){if(t>=1&&10>t)switch(e){case i.MODE_NUMBER:return 10;case i.MODE_ALPHA_NUM:return 9;case i.MODE_8BIT_BYTE:return 8;case i.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>t)switch(e){case i.MODE_NUMBER:return 12;case i.MODE_ALPHA_NUM:return 11;case i.MODE_8BIT_BYTE:return 16;case i.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>t))throw new Error("type:"+t);switch(e){case i.MODE_NUMBER:return 14;case i.MODE_ALPHA_NUM:return 13;case i.MODE_8BIT_BYTE:return 16;case i.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},s.getLostPoint=function(e){for(var t=e.getModuleCount(),i=0,o=0;t>o;o+=1)for(var r=0;t>r;r+=1){for(var a=0,l=e.isDark(o,r),n=-1;1>=n;n+=1)if(!(0>o+n||o+n>=t))for(var s=-1;1>=s;s+=1)0>r+s||r+s>=t||(0!=n||0!=s)&&l==e.isDark(o+n,r+s)&&(a+=1);a>5&&(i+=3+a-5)}for(var o=0;t-1>o;o+=1)for(var r=0;t-1>r;r+=1){var d=0;e.isDark(o,r)&&(d+=1),e.isDark(o+1,r)&&(d+=1),e.isDark(o,r+1)&&(d+=1),e.isDark(o+1,r+1)&&(d+=1),(0==d||4==d)&&(i+=3)}for(var o=0;t>o;o+=1)for(var r=0;t-6>r;r+=1)e.isDark(o,r)&&!e.isDark(o,r+1)&&e.isDark(o,r+2)&&e.isDark(o,r+3)&&e.isDark(o,r+4)&&!e.isDark(o,r+5)&&e.isDark(o,r+6)&&(i+=40);for(var r=0;t>r;r+=1)for(var o=0;t-6>o;o+=1)e.isDark(o,r)&&!e.isDark(o+1,r)&&e.isDark(o+2,r)&&e.isDark(o+3,r)&&e.isDark(o+4,r)&&!e.isDark(o+5,r)&&e.isDark(o+6,r)&&(i+=40);for(var c=0,r=0;t>r;r+=1)for(var o=0;t>o;o+=1)e.isDark(o,r)&&(c+=1);var y=Math.abs(100*c/t/t-50)/5;return i+=10*y},s}(),l=function(){for(var e=new Array(256),t=new Array(256),i=0;8>i;i+=1)e[i]=1<<i;for(var i=8;256>i;i+=1)e[i]=e[i-4]^e[i-5]^e[i-6]^e[i-8];for(var i=0;255>i;i+=1)t[e[i]]=i;var o={};return o.glog=function(e){if(1>e)throw new Error("glog("+e+")");return t[e]},o.gexp=function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return e[t]},o}(),n=function(){var e=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16]],t=function(e,t){var i={};return i.totalCount=e,i.dataCount=t,i},i={},r=function(t,i){switch(i){case o.L:return e[4*(t-1)+0];case o.M:return e[4*(t-1)+1];case o.Q:return e[4*(t-1)+2];case o.H:return e[4*(t-1)+3];default:return void 0}};return i.getRSBlocks=function(e,i){var o=r(e,i);if("undefined"==typeof o)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+i);for(var a=o.length/3,l=new Array,n=0;a>n;n+=1)for(var s=o[3*n+0],d=o[3*n+1],c=o[3*n+2],y=0;s>y;y+=1)l.push(t(d,c));return l},i}(),s=function(){var e=new Array,t=0,i={};return i.getBuffer=function(){return e},i.get=function(t){var i=Math.floor(t/8);return 1==(e[i]>>>7-t%8&1)},i.put=function(e,t){for(var o=0;t>o;o+=1)i.putBit(1==(e>>>t-o-1&1))},i.getLengthInBits=function(){return t},i.putBit=function(i){var o=Math.floor(t/8);e.length<=o&&e.push(0),i&&(e[o]|=128>>>t%8),t+=1},i},d=function(e){var o=i.MODE_8BIT_BYTE,r=t.stringToBytes(e),a={};return a.getMode=function(){return o},a.getLength=function(){return r.length},a.write=function(e){for(var t=0;t<r.length;t+=1)e.put(r[t],8)},a},c=function(){var e=new Array,t={};return t.writeByte=function(t){e.push(255&t)},t.writeShort=function(e){t.writeByte(e),t.writeByte(e>>>8)},t.writeBytes=function(e,i,o){i=i||0,o=o||e.length;for(var r=0;o>r;r+=1)t.writeByte(e[r+i])},t.writeString=function(e){for(var i=0;i<e.length;i+=1)t.writeByte(e.charCodeAt(i))},t.toByteArray=function(){return e},t.toString=function(){var t="";t+="[";for(var i=0;i<e.length;i+=1)i>0&&(t+=","),t+=e[i];return t+="]"},t},y=function(){var e=0,t=0,i=0,o="",r={},a=function(e){o+=String.fromCharCode(l(63&e))},l=function(e){if(0>e);else{if(26>e)return 65+e;if(52>e)return 97+(e-26);if(62>e)return 48+(e-52);if(62==e)return 43;if(63==e)return 47}throw new Error("n:"+e)};return r.writeByte=function(o){for(e=e<<8|255&o,t+=8,i+=1;t>=6;)a(e>>>t-6),t-=6},r.flush=function(){if(t>0&&(a(e<<6-t),e=0,t=0),i%3!=0)for(var r=3-i%3,l=0;r>l;l+=1)o+="="},r.toString=function(){return o},r},_=function(e){var t=e,i=0,o=0,r=0,a={};a.read=function(){for(;8>r;){if(i>=t.length){if(0==r)return-1;throw new Error("unexpected end of file./"+r)}var e=t.charAt(i);if(i+=1,"="==e)return r=0,-1;e.match(/^\s$/)||(o=o<<6|l(e.charCodeAt(0)),r+=6)}var a=o>>>r-8&255;return r-=8,a};var l=function(e){if(e>=65&&90>=e)return e-65;if(e>=97&&122>=e)return e-97+26;if(e>=48&&57>=e)return e-48+52;if(43==e)return 62;if(47==e)return 63;throw new Error("c:"+e)};return a},f=function(e,t){var i=e,o=t,r=new Array(e*t),a={};a.setPixel=function(e,t,o){r[t*i+e]=o},a.write=function(e){e.writeString("GIF87a"),e.writeShort(i),e.writeShort(o),e.writeByte(128),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(255),e.writeByte(255),e.writeByte(255),e.writeString(","),e.writeShort(0),e.writeShort(0),e.writeShort(i),e.writeShort(o),e.writeByte(0);var t=2,r=n(t);e.writeByte(t);for(var a=0;r.length-a>255;)e.writeByte(255),e.writeBytes(r,a,255),a+=255;e.writeByte(r.length-a),e.writeBytes(r,a,r.length-a),e.writeByte(0),e.writeString(";")};var l=function(e){var t=e,i=0,o=0,r={};return r.write=function(e,r){if(e>>>r!=0)throw new Error("length over");for(;i+r>=8;)t.writeByte(255&(e<<i|o)),r-=8-i,e>>>=8-i,o=0,i=0;o=e<<i|o,i+=r},r.flush=function(){i>0&&t.writeByte(o)},r},n=function(e){for(var t=1<<e,i=(1<<e)+1,o=e+1,a=s(),n=0;t>n;n+=1)a.add(String.fromCharCode(n));a.add(String.fromCharCode(t)),a.add(String.fromCharCode(i));var d=c(),y=l(d);y.write(t,o);var _=0,f=String.fromCharCode(r[_]);for(_+=1;_<r.length;){var u=String.fromCharCode(r[_]);_+=1,a.contains(f+u)?f+=u:(y.write(a.indexOf(f),o),a.size()<4095&&(a.size()==1<<o&&(o+=1),a.add(f+u)),f=u)}return y.write(a.indexOf(f),o),y.write(i,o),y.flush(),d.toByteArray()},s=function(){var e={},t=0,i={};return i.add=function(o){if(i.contains(o))throw new Error("dup key:"+o);e[o]=t,t+=1},i.size=function(){return t},i.indexOf=function(t){return e[t]},i.contains=function(t){return"undefined"!=typeof e[t]},i};return a},u=function(e,t,i,o){for(var r=f(e,t),a=0;t>a;a+=1)for(var l=0;e>l;l+=1)r.setPixel(l,a,i(l,a));var n=c();r.write(n);for(var s=y(),d=n.toByteArray(),_=0;_<d.length;_+=1)s.writeByte(d[_]);s.flush();var u="";return u+="<img",u+=' src="',u+="data:image/gif;base64,",u+=s,u+='"',u+=' width="',u+=e,u+='"',u+=' height="',u+=t,u+='"',o&&(u+=' alt="',u+=o,u+='"'),u+="/>"};return t}();exports.QRCode=function(){var e=function(){},t=function(i){var o;return o=this instanceof t?this:new e,i||(i={}),o.qr=qrcode(i.typeNumber||4,i.errorCorrectLevel||"M"),o};return e.prototype=t.prototype,t.prototype.createQRCodeView=function(e){var t=this;t.qr.addData(e.text),t.qr.make(),e||(e={});var i,o=e.width||null,r=e.height||null,a=e.margin||10;null===o&&null===r?(i=2,e.margin||(a=4*i)):o>=r?i=parseInt((o-2*a)/t.qr.getModuleCount(),10):r>o&&(i=parseInt((r-2*a)/t.qr.getModuleCount(),10));var l=t.qr.createImgTag(i,a);return e.image=Ti.Utils.base64decode(l.split(",")[1].split('"')[0]),null===o&&null===r&&(e.width=l.match(/width=\"([0-9]+)\"/)[1],e.height=l.match(/height=\"([0-9]+)\"/)[1]),e.image=Ti.Utils.base64decode(t.qr.createImgTag(i,a).split(",")[1].split('"')[0]),Ti.UI.createImageView(e)},t}(this);