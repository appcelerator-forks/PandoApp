function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){Alloy.Globals.Navigator.open("personal_upload")}function t(e){var t=parent({name:"f_id"},e.source),i=parent({name:"id"},e.source);console.log(t+" "+i),Alloy.Globals.Navigator.open("conversation",{f_id:t,id:i})}function i(e){var t=parent({name:"item_response_id"},e.source);Alloy.Globals.Navigator.open("personal_waiting_list",{id:t})}function o(){var e=s.UI.create("View",{classes:["wfill"],backgroundColor:"#f1f5f7",height:40}),o=s.UI.create("Label",{classes:["h5","wfill","hsize","padding"],text:"ITEMS(S) WAITING TO BE PAIRED",color:"#2eafa8"});e.add(o);for(var a=s.UI.create("TableViewSection",{headerView:e}),r=0;r<h.length;r++){var l=s.UI.create("TableViewRow",{}),n=s.UI.create("View",{classes:["wfill","horz"],height:70,backgroundColor:"#ffffff",item_response_id:h[r].id});s.UI.create("View",{classes:["indicator_yellow"]});var _=s.UI.create("ImageView",{width:70,height:70,defaultImage:"/images/default/small_item.png",image:h[r].img_path}),d=s.UI.create("View",{classes:["horz_div"]}),c=s.UI.create("View",{classes:["hfill","vert","padding"],width:"auto"}),g=h[r].total||0,m=s.UI.create("Label",{classes:["h5","wfill","hsize"],textAlign:"left",text:h[r].item_name}),p=s.UI.create("Label",{classes:["h6","wfill","hsize","font_light_grey"],textAlign:"left",text:g+" people interest on it"});c.add(m),c.add(p),n.add(_),n.add(d),n.add(c),l.add(n),a.add(l),n.addEventListener("click",i)}var f=s.UI.create("View",{classes:["wfill"],backgroundColor:"#f1f5f7",height:40}),v=s.UI.create("Label",{classes:["h5","wfill","hsize","padding"],text:"ITEM(S) WAITING TO PICKUP",color:"#2eafa8"});f.add(v);for(var w=s.UI.create("TableViewSection",{headerView:f}),r=0;r<u.length;r++){var l=s.UI.create("TableViewRow",{}),n=s.UI.create("View",{classes:["wfill","horz"],height:70,backgroundColor:"#ffffff",f_id:u[r].receiver_id,id:u[r].id});s.UI.create("View",{classes:["indicator_green"]});var _=s.UI.create("ImageView",{width:70,height:70,defaultImage:"/images/default/small_item.png",image:u[r].img_path}),d=s.UI.create("View",{classes:["horz_div"]}),c=s.UI.create("View",{classes:["hsize","vert","padding"],width:"auto"}),g=u[r].total||0,m=s.UI.create("Label",{classes:["h5","wfill","hsize"],textAlign:"left",text:u[r].item_name}),y=s.UI.create("Label",{classes:["h5","wfill","hsize"],textAlign:"left",text:u[r].receiver_name}),p=s.UI.create("Label",{classes:["h6","wfill","hsize","font_light_grey"],textAlign:"left",text:I[u[r].status-1]});c.add(m),c.add(y),c.add(p),n.add(_),n.add(d),n.add(c),l.add(n),w.add(l),n.addEventListener("click",t)}s.tblview.setData([a,w])}function a(e){var t=Alloy.createCollection("updateChecker"),i=t.getCheckerById(1),o=i.updated||"";API.callByPost({url:"getItemListUrl",params:{last_updated:o}},function(i){var o=Alloy.createCollection("items"),a=JSON.parse(i),r=a.data||null;o.saveArray(r),t.updateModule(1,"items",Common.now()),e&&e()})}function r(e){var t=Alloy.createCollection("updateChecker"),i=Ti.App.Properties.getString("user_id"),o=t.getCheckerById(2,i);o.updated||"",API.callByPost({url:"getItemResponseByUidUrl",params:{last_updated:"",u_id:i}},function(o){var a=Alloy.createCollection("item_response"),r=JSON.parse(o),l=r.data||null;a.saveArray(l),t.updateModule(2,"item_response",Common.now(),i),e&&e()})}function l(){g.start(),a(function(){r(function(){var e=Alloy.createCollection("items");h=e.getWaitingDataByOwner(),u=e.getMatchingDataByOwner(),o(),g.finish()})})}function n(){s.win.add(g.getView()),l()}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="personal",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var s=this,d={},c={};s.__views.win=Ti.UI.createWindow({backgroundColor:"#E4E6E1",titleAttributes:{color:"#eaebe6"},navBarHidden:"false",font:{fontFamily:"Lato-Regular"},barColor:"#75d0cb",id:"win",title:"Personal"}),s.__views.win&&s.addTopLevelView(s.__views.win),s.__views.__alloyId62=Ti.UI.createButton({title:"Upload Item",id:"__alloyId62"}),e?s.addListener(s.__views.__alloyId62,"click",e):c["$.__views.__alloyId62!click!navToPersonalUpload"]=!0,s.__views.win.rightNavButton=s.__views.__alloyId62,s.__views.tblview=Ti.UI.createTableView({contentHeight:Ti.UI.SIZE,contentWidth:Ti.UI.FILL,id:"tblview",editable:"true"}),s.__views.win.add(s.__views.tblview),d.destroy=function(){},_.extend(s,s.__views),arguments[0]||{},Ti.App.Properties.getString("user_id"),Alloy.createCollection("items");var h,u,g=Alloy.createController("loading"),I=["Active","Waiting for receive","Banned","Removed","TRANSACTION SUCCESS"];n(),Ti.App.addEventListener("personal:refresh",l),s.win.addEventListener("close",function(){s.destroy(),console.log("window close"),Ti.App.removeEventListener("personal:refresh",l)}),c["$.__views.__alloyId62!click!navToPersonalUpload"]&&s.addListener(s.__views.__alloyId62,"click",e),_.extend(s,d)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;