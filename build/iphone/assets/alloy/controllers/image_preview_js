function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){r.win.close()}function t(){}function i(){l=r.inner_box.toImage(),console.log(l);var t={media:l};Ti.App.fireEvent("imagePreview: imageCallback",t),e()}function o(){r.win.add(c.getView());var e=Titanium.Platform.displayCaps.platformWidth;r.inner_box.width=e,r.inner_box.height=e;var t=r.UI.create("ImageView",{image:d,zIndex:10,opacity:.8}),i=t.rect.height,o=t.rect.width,a={},n=!1,l=!1;t.addEventListener("pinch",function(e){0==l&&(n=!0,t.height=i*e.scale,t.width=o*e.scale)}),t.addEventListener("touchstart",function(e){a.x=e.x,a.y=e.y,i=t.rect.height,o=t.rect.width,0==i&&(i=t.rect.height,o=t.rect.width)}),t.addEventListener("touchend",function(){n=!1,l=!1,i=t.rect.height,o=t.rect.width}),r.inner_box.add(t)}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="image_preview",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var r=this,a={},n={};r.__views.win=Ti.UI.createWindow({backgroundColor:"#ebebeb",titleAttributes:{color:"#ffffff"},navBarHidden:"false",font:{fontFamily:"Lato-Regular"},barColor:"#75d0cb",id:"win",title:"Image Preview"}),r.__views.win&&r.addTopLevelView(r.__views.win),r.__views.__alloyId35=Ti.UI.createButton({title:"Cancel",id:"__alloyId35"}),r.__views.win.rightNavButton=r.__views.__alloyId35,t?r.addListener(r.__views.__alloyId35,"keypressed",t):n["$.__views.__alloyId35!keypressed!onCancel"]=!0,r.__views.__alloyId36=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.FILL,backgroundColor:"#ddd",id:"__alloyId36"}),r.__views.win.add(r.__views.__alloyId36),r.__views.cropimage=Ti.UI.createView({width:Ti.UI.SIZE,height:Ti.UI.SIZE,id:"cropimage"}),r.__views.__alloyId36.add(r.__views.cropimage),r.__views.inner_box=Ti.UI.createScrollView({id:"inner_box",backgroundColor:"#fff",contentHeight:Ti.UI.SIZE,contentWidth:Ti.UI.SIZE}),r.__views.cropimage.add(r.__views.inner_box),r.__views.__alloyId37=Ti.UI.createButton({borderColor:"#75d0cb",backgroundColor:"#ffffff",color:"#75d0cb",textAlign:Titanium.UI.TEXT_ALIGNMENT_CENTER,width:"80",height:Ti.UI.SIZE,font:{fontSize:14,fontFamily:"Lato-Regular"},title:"Send",top:"10",id:"__alloyId37"}),r.__views.__alloyId36.add(r.__views.__alloyId37),i?r.addListener(r.__views.__alloyId37,"click",i):n["$.__views.__alloyId37!click!image_save"]=!0,a.destroy=function(){},_.extend(r,r.__views);var l,s=arguments[0]||{},d=s.media,c=Alloy.createController("loading");r.getMedia=function(){return l},o(),r.win.addEventListener("close",function(){r.destroy(),console.log("window close")}),n["$.__views.__alloyId35!keypressed!onCancel"]&&r.addListener(r.__views.__alloyId35,"keypressed",t),n["$.__views.__alloyId37!click!image_save"]&&r.addListener(r.__views.__alloyId37,"click",i),_.extend(r,a)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;