function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(e){var t=parent({name:"f_id"},e.source);Alloy.Globals.Navigator.open("friends_items",{f_id:t})}function t(){o.inner_box.removeAllChildren();for(var t=0;t<l.length;t++){var i=o.UI.create("View",{classes:["hsize","wfill","horz"],f_id:l[t].f_id}),r=o.UI.create("ImageView",{top:10,width:60,height:"auto",image:l[t].thumb_path,defaultImage:"/images/default/small_item.png"}),a=o.UI.create("View",{classes:["hsize","vert","padding"],width:"70%"}),n=l[t].total||0,s=o.UI.create("Label",{classes:["h5","wfill","hsize"],textAlign:"left",text:l[t].fullname}),d=o.UI.create("Label",{classes:["h6","wfill","hsize"],color:"#333333",textAlign:"left",text:n+" unread message."});a.add(s),a.add(d),i.add(r),i.add(a),o.inner_box.add(i),i.addEventListener("click",e)}}function i(){n.start();var e=Ti.App.Properties.getString("user_id")||0,i=Alloy.createCollection("updateChecker"),r=i.getCheckerById(3,e),a=r.updated||"";console.log(e),API.callByPost({url:"getFriendListUrl",params:{last_updated:a,u_id:e}},function(r){var a=Alloy.createCollection("friends"),s=JSON.parse(r),d=s.data||null;a.saveArray(d),l=a.getData(),i.updateModule(3,"friends",Common.now(),e),t(),o.label_friends.text="Friends ("+l.length+")",n.finish()})}function r(){o.win.add(n.getView()),i()}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="friends",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var o=this,a={};o.__views.win=Ti.UI.createWindow({backgroundColor:"#E4E6E1",titleAttributes:{color:"#eaebe6"},navBarHidden:"false",font:{fontFamily:"Lato-Regular"},barColor:"#75d0cb",id:"win",title:"Friends"}),o.__views.win&&o.addTopLevelView(o.__views.win),o.__views.__alloyId9=Ti.UI.createScrollView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.FILL,contentHeight:Ti.UI.SIZE,contentWidth:Ti.UI.FILL,id:"__alloyId9"}),o.__views.win.add(o.__views.__alloyId9),o.__views.__alloyId10=Ti.UI.createView({width:Ti.UI.FILL,height:Ti.UI.SIZE,id:"__alloyId10"}),o.__views.__alloyId9.add(o.__views.__alloyId10),o.__views.__alloyId11=Ti.UI.createView({layout:"vertical",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:10,left:10,right:10,bottom:10,id:"__alloyId11"}),o.__views.__alloyId10.add(o.__views.__alloyId11),o.__views.label_friends=Ti.UI.createLabel({color:"#2a363a",width:Ti.UI.SIZE,height:Ti.UI.SIZE,font:{fontFamily:"Lato-Light",fontSize:24},text:"Friends (0)",id:"label_friends"}),o.__views.__alloyId11.add(o.__views.label_friends),o.__views.__alloyId12=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,top:"0",left:10,right:10,bottom:10,borderColor:"#d2d3ce",backgroundColor:"#f6f6f6",id:"__alloyId12"}),o.__views.__alloyId9.add(o.__views.__alloyId12),o.__views.__alloyId13=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,top:"0",backgroundColor:"#e5e5e5",id:"__alloyId13"}),o.__views.__alloyId12.add(o.__views.__alloyId13),o.__views.inner_box=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,top:"0",left:10,right:10,bottom:10,id:"inner_box"}),o.__views.__alloyId13.add(o.__views.inner_box),a.destroy=function(){},_.extend(o,o.__views),arguments[0]||{};var n=Alloy.createController("loading"),s=Alloy.createCollection("friends"),l=s.getData();r(),Ti.App.addEventListener("friends:refresh",i),o.win.addEventListener("close",function(){Ti.App.removeEventListener("friends:refresh",i),o.destroy(),console.log("window close")}),_.extend(o,a)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;