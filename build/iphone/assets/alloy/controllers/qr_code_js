function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){r.win.close()}function t(){var e=require("scanner"),t=e.createScannerWindow();e.createScannerButton(),e.init(t),e.openScanner("1")}function i(){var e=require("qrcode");console.log(s+"||"+h+"||"+c);var t=e.QRCode({typeNumber:4,errorCorrectLevel:"M"}),i=t.createQRCodeView({width:200,height:200,margin:4,text:s+"||"+h+"||"+c});return i}function o(i){console.log(i.res);var o=i.res,a=o[0],r=o[1],l=Ti.App.Properties.getString("user_id")||0;API.callByPost({url:"validateTransactionCodeUrl",params:{code:r,item_id:a,receiver_id:l}},function(i){var o=JSON.parse(i);if("success"==o.status){console.log(a+" "+r+" "+l+" after scan");var n=o.data;console.log(n);var s=Alloy.createCollection("items");s.saveArray(n),Common.createAlert("Notification","Item pairing is successful.",function(){Ti.App.fireEvent("conversation:refresh")}),e()}else Common.createAlert("Notification",o.error_code,t)})}function a(){r.win.add(u.getView()),u.start(),d?r.qrcode.add(i()):t(),u.finish()}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="qr_code",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var r=this,l={};r.__views.win=Ti.UI.createWindow({backgroundColor:"#E4E6E1",titleAttributes:{color:"#eaebe6"},navBarHidden:"false",font:{fontFamily:"Lato-Regular"},barColor:"#75d0cb",id:"win",title:"Code"}),r.__views.win&&r.addTopLevelView(r.__views.win),r.__views.__alloyId78=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.FILL,backgroundColor:"#ddd",id:"__alloyId78"}),r.__views.win.add(r.__views.__alloyId78),r.__views.qrcode=Ti.UI.createView({width:Ti.UI.SIZE,height:Ti.UI.SIZE,id:"qrcode"}),r.__views.__alloyId78.add(r.__views.qrcode),l.destroy=function(){},_.extend(r,r.__views);var n=arguments[0]||{},s=n.item_id,d=n.owner||0,c=n.owner_id||0,h=n.code||0,u=Alloy.createController("loading");console.log(s),a(),Ti.App.addEventListener("qr_code:update_compelete_code",o),r.win.addEventListener("close",function(){Ti.App.removeEventListener("qr_code:update_compelete_code",o),r.destroy(),console.log("window close")}),_.extend(r,l)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;