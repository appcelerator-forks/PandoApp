function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){Alloy.createController("in_app_purchase")}function t(){var e=Titanium.UI.createOptionDialog({title:"Choose an image source...",options:["Camera","Photo Gallery","Cancel"],cancel:2});e.addEventListener("click",function(e){0==e.index?Titanium.Media.showCamera({success:function(e){c=Alloy.Globals.Navigator.open("image_preview",{media:e.media})},cancel:function(){},error:function(e){var t=Titanium.UI.createAlertDialog({title:"Camera"});t.setMessage(e.code==Titanium.Media.NO_CAMERA?"Device does not have camera":"Unexpected error: "+e.code),t.show()},allowImageEditing:!0,mediaTypes:[Ti.Media.MEDIA_TYPE_PHOTO],saveToPhotoGallery:!0}):1==e.index&&Titanium.Media.openPhotoGallery({success:function(e){c=Alloy.Globals.Navigator.open("image_preview",{media:e.media})},cancel:function(){},mediaTypes:[Ti.Media.MEDIA_TYPE_PHOTO]})}),e.show()}function i(){g.start(),Ti.App.Properties.getString("user_id");var e="android"==Ti.Platform.osname?n.item_image.toImage().media:n.item_image.toImage(),t={Filedata:e,u_id:u,fullname:n.fullname.value,email:n.email.value,mobile:n.mobile.value,photoLoad:h};API.callByPostImage({url:"updateProfileUrl",params:t},function(e){var i=JSON.parse(e);return"error"==i.status?(Common.createAlert("Error",i.data[0]),g.finish(),!1):(g.finish(),Ti.App.Properties.setString("fullname",t.fullname),Ti.App.Properties.setString("email",t.email),Ti.App.Properties.setString("mobile",t.mobile),Ti.App.Properties.setString("img_path",i.data.img_path),Ti.App.Properties.setString("thumb_path",i.data.thumb_path),void Common.createAlert("Notification","Profile Update Successful",function(){n.win.close()}))})}function o(){n.win.close()}function a(){var e=Ti.App.Properties.getString("fullname"),t=Ti.App.Properties.getString("email"),i=Ti.App.Properties.getString("mobile"),o=Ti.App.Properties.getString("img_path")||"images/icons/default_avatar.png";n.fullname.value=e,n.email.value=t,n.mobile.value=i,n.item_image.image=o}function r(){var e=c.getMedia();n.item_image.image=e,h=1}function l(){var e=Alloy.createController("_left_right"),t="Swipe left or right to select";e.generate_button(n.inner_box,t,i,o),e.generate_indicator(n.item_container),a(),n.win.add(g.getView())}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="setting_profile",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var n=this,s={},d={};n.__views.win=Ti.UI.createWindow({backgroundColor:"#ebebeb",titleAttributes:{color:"#ffffff"},navBarHidden:"false",font:{fontFamily:"Lato-Regular"},barColor:"#323136",id:"win",title:"Profile"}),n.__views.win&&n.addTopLevelView(n.__views.win),n.__views.__alloyId92=Ti.UI.createButton({title:"Upgrade",id:"__alloyId92"}),e?n.addListener(n.__views.__alloyId92,"click",e):d["$.__views.__alloyId92!click!buy_premium_account"]=!0,n.__views.win.rightNavButton=n.__views.__alloyId92,n.__views.__alloyId93=Ti.UI.createScrollView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.FILL,contentHeight:Ti.UI.SIZE,contentWidth:Ti.UI.FILL,id:"__alloyId93"}),n.__views.win.add(n.__views.__alloyId93),n.__views.item_container=Ti.UI.createView({width:Ti.UI.FILL,height:Ti.UI.SIZE,top:"0",left:10,right:10,bottom:"0",borderColor:"#a5a5a5",backgroundColor:"#ffffff",id:"item_container"}),n.__views.__alloyId93.add(n.__views.item_container),n.__views.inner_box=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,top:10,left:10,right:10,bottom:"0",id:"inner_box",backgroundColor:"#F2F4F5"}),n.__views.item_container.add(n.__views.inner_box),n.__views.__alloyId94=Ti.UI.createLabel({color:"#2a363a",width:Ti.UI.FILL,height:Ti.UI.SIZE,font:{fontFamily:"Lato-Regular",fontSize:14},text:"Upload profile",id:"__alloyId94"}),n.__views.inner_box.add(n.__views.__alloyId94),n.__views.__alloyId95=Ti.UI.createView({width:Ti.UI.FILL,height:Ti.UI.SIZE,top:"10",id:"__alloyId95"}),n.__views.inner_box.add(n.__views.__alloyId95),n.__views.item_image=Ti.UI.createImageView({preventDefaultImage:!0,id:"item_image",defaultImage:"/images/default/item.png",image:"/images/icons/icon_take_photo.png",width:"60%"}),n.__views.__alloyId95.add(n.__views.item_image),t?n.addListener(n.__views.item_image,"click",t):d["$.__views.item_image!click!loadPhoto"]=!0,n.__views.fullname=Ti.UI.createTextField({height:40,borderColor:"#a5a5a5",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,verticalAlign:Titanium.UI.TEXT_VERTICAL_ALIGNMENT_CENTER,textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,backgroundColor:"#ffffff",width:Titanium.UI.FILL,left:10,right:10,top:10,font:{fontFamily:"Lato-Regular"},color:"#000000",id:"fullname",hintText:"Fullname"}),n.__views.inner_box.add(n.__views.fullname),n.__views.mobile=Ti.UI.createTextField({height:40,borderColor:"#a5a5a5",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,verticalAlign:Titanium.UI.TEXT_VERTICAL_ALIGNMENT_CENTER,textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,backgroundColor:"#ffffff",width:Titanium.UI.FILL,left:10,right:10,top:10,font:{fontFamily:"Lato-Regular"},color:"#000000",id:"mobile",hintText:"Mobile Number"}),n.__views.inner_box.add(n.__views.mobile),n.__views.email=Ti.UI.createTextField({height:40,borderColor:"#a5a5a5",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,verticalAlign:Titanium.UI.TEXT_VERTICAL_ALIGNMENT_CENTER,textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,backgroundColor:"#ffffff",width:Titanium.UI.FILL,left:10,right:10,top:10,font:{fontFamily:"Lato-Regular"},color:"#000000",id:"email",hintText:"Email Address"}),n.__views.inner_box.add(n.__views.email),n.__views.__alloyId96=Ti.UI.createImageView({preventDefaultImage:!0,width:Ti.UI.FILL,height:Ti.UI.SIZE,image:"/images/shadow.png",left:"10",right:"10",id:"__alloyId96"}),n.__views.__alloyId93.add(n.__views.__alloyId96),s.destroy=function(){},_.extend(n,n.__views),arguments[0]||{};var c,u=Ti.App.Properties.getString("user_id"),h=0,g=Alloy.createController("loading");l(),Ti.App.addEventListener("imagePreview: imageCallback",r),n.win.addEventListener("close",function(){Ti.App.addEventListener("imagePreview: imageCallback",r),n.destroy(),console.log("window close")}),d["$.__views.__alloyId92!click!buy_premium_account"]&&n.addListener(n.__views.__alloyId92,"click",e),d["$.__views.item_image!click!loadPhoto"]&&n.addListener(n.__views.item_image,"click",t),_.extend(n,s)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;