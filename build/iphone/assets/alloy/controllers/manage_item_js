function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){Alloy.Globals.Navigator.open("personal_upload")}function t(){"donate"==g?o():i()}function i(){var t=Alloy.createCollection("items");data=t.getData();var i=[];i.push(o);var o=d.UI.create("TableViewRow",{}),a=d.UI.create("View",{classes:["wfill","horz","hsize"],backgroundColor:"#ffffff"}),r=d.UI.create("Label",{classes:["h5","wfill","hsize","padding"],text:"Donate your stuff to other."});a.add(r),o.add(a),o.addEventListener("click",e);for(var n=0;n<data.length;n++){var l=d.UI.create("TableViewRow",{}),s=d.UI.create("View",{classes:["wfill","horz"],height:70,backgroundColor:"#ffffff",item_response_id:data[n].id}),_=d.UI.create("ImageView",{width:70,height:70,defaultImage:"/images/default/small_item.png",image:data[n].img_path}),c=d.UI.create("View",{classes:["hfill","vert","padding"],width:"auto"}),u=d.UI.create("Label",{classes:["h5","wfill","hsize"],textAlign:"left",text:data[n].item_name}),h=d.UI.create("Label",{classes:["h6","wfill","hsize","font_light_grey"],textAlign:"left",text:I[data[n].status]});c.add(u),c.add(h),s.add(_),s.add(c),l.add(s),i.push(l)}d.tblview.setData(i)}function o(){var t=Alloy.createCollection("items");data=t.getWaitingDataByOwner();var i=[],o=d.UI.create("TableViewRow",{}),a=d.UI.create("View",{classes:["wfill","horz","hsize"],backgroundColor:"#ffffff"}),r=d.UI.create("Label",{classes:["h5","wfill","hsize","padding"],textAlign:"center",text:"Click here. Donate your stuff to other."});a.add(r),o.add(a),o.addEventListener("click",e),i.push(o);for(var n=0;n<data.length;n++){var l=d.UI.create("TableViewRow",{}),s=d.UI.create("View",{classes:["wfill","horz"],height:70,backgroundColor:"#ffffff",item_response_id:data[n].id}),_=d.UI.create("ImageView",{width:70,height:70,defaultImage:"/images/default/small_item.png",image:data[n].img_path}),c=d.UI.create("View",{classes:["hfill","vert","padding"],width:"auto"}),u=data[n].total||0,h=d.UI.create("Label",{classes:["h5","wfill","hsize"],textAlign:"left",text:data[n].item_name}),g=d.UI.create("Label",{classes:["h6","wfill","hsize","font_light_grey"],textAlign:"left",text:u+" people interest on it"});c.add(h),c.add(g),s.add(_),s.add(c),l.add(s),i.push(l)}d.tblview.setData(i)}function a(e){var t=Alloy.createCollection("updateChecker"),i=t.getCheckerById(1),o=i.updated||"";API.callByPost({url:"getItemListUrl",params:{last_updated:o}},function(i){var o=Alloy.createCollection("items"),a=JSON.parse(i),r=a.data||null;o.saveArray(r),t.updateModule(1,"items",Common.now()),e&&e()})}function r(e){var t=Alloy.createCollection("updateChecker"),i=Ti.App.Properties.getString("user_id"),o=t.getCheckerById(2,i);o.updated||"",API.callByPost({url:"getItemResponseByUidUrl",params:{last_updated:"",u_id:i}},function(o){var a=Alloy.createCollection("item_response"),r=JSON.parse(o),n=r.data||null;a.saveArray(n),t.updateModule(2,"item_response",Common.now(),i),e&&e()})}function n(){h.start(),a(function(){r(function(){t(),h.finish()})})}function l(e){var t=parent({name:"tab"},e.source),i=children({name:"v",value:"label"},d.firstTab),o=children({name:"v",value:"label"},d.secondTab);1==t?(g="donate",d.firstTab.backgroundColor="#75d0cb",i.color="#ffffff",d.secondTab.backgroundColor="transparent",o.color="#75d0cb"):2==t&&(g="adopt",d.secondTab.backgroundColor="#75d0cb",o.color="#ffffff",d.firstTab.backgroundColor="transparent",i.color="#75d0cb"),n()}function s(){d.win.add(h.getView()),n()}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="manage_item",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var d=this,c={},u={};d.__views.win=Ti.UI.createWindow({backgroundColor:"#ebebeb",titleAttributes:{color:"#ffffff"},navBarHidden:"false",font:{fontFamily:"Lato-Regular"},barColor:"#323136",id:"win",title:"Items"}),d.__views.win&&d.addTopLevelView(d.__views.win),d.__views.__alloyId55=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.FILL,id:"__alloyId55"}),d.__views.win.add(d.__views.__alloyId55),d.__views.__alloyId56=Ti.UI.createView({width:Ti.UI.FILL,height:Ti.UI.SIZE,id:"__alloyId56"}),d.__views.__alloyId55.add(d.__views.__alloyId56),d.__views.__alloyId57=Ti.UI.createView({layout:"horizontal",width:Ti.UI.FILL,height:Ti.UI.SIZE,top:10,left:10,right:10,bottom:10,horizontalWrap:"false",borderColor:"#75d0cb",borderRadius:"5",id:"__alloyId57"}),d.__views.__alloyId56.add(d.__views.__alloyId57),d.__views.firstTab=Ti.UI.createView({id:"firstTab",tab:"1",backgroundColor:"#75d0cb",height:"40",width:"50%"}),d.__views.__alloyId57.add(d.__views.firstTab),l?d.addListener(d.__views.firstTab,"click",l):u["$.__views.firstTab!click!switchListing"]=!0,d.__views.__alloyId58=Ti.UI.createLabel({color:"#ffffff",width:Ti.UI.FILL,height:Ti.UI.FILL,font:{fontFamily:"Lato-Regular",fontSize:12},text:"DONATE",v:"label",top:"10",bottom:"10",textAlign:"center",id:"__alloyId58"}),d.__views.firstTab.add(d.__views.__alloyId58),d.__views.__alloyId59=Ti.UI.createView({height:"40",width:"1",backgroundColor:"#75d0cb",id:"__alloyId59"}),d.__views.__alloyId57.add(d.__views.__alloyId59),d.__views.secondTab=Ti.UI.createView({tab:"2",id:"secondTab",height:"40",width:"50%"}),d.__views.__alloyId57.add(d.__views.secondTab),l?d.addListener(d.__views.secondTab,"click",l):u["$.__views.secondTab!click!switchListing"]=!0,d.__views.__alloyId60=Ti.UI.createLabel({color:"#75d0cb",width:Ti.UI.FILL,height:Ti.UI.FILL,font:{fontFamily:"Lato-Regular",fontSize:12},text:"ADOPT",v:"label",top:"10",bottom:"10",textAlign:"center",id:"__alloyId60"}),d.__views.secondTab.add(d.__views.__alloyId60),d.__views.tblview=Ti.UI.createTableView({contentHeight:Ti.UI.SIZE,contentWidth:Ti.UI.FILL,width:Ti.UI.FILL,height:Ti.UI.FILL,id:"tblview"}),d.__views.__alloyId55.add(d.__views.tblview),c.destroy=function(){},_.extend(d,d.__views),arguments[0]||{};var h=Alloy.createController("loading"),g="donate",I=["","This item is waiting to be selected.","Item taken"];s(),Ti.App.addEventListener("manage_item:refresh",n),d.win.addEventListener("close",function(){Ti.App.removeEventListener("friends:refresh",n),d.destroy(),console.log("window close")}),u["$.__views.firstTab!click!switchListing"]&&d.addListener(d.__views.firstTab,"click",l),u["$.__views.secondTab!click!switchListing"]&&d.addListener(d.__views.secondTab,"click",l),_.extend(d,c)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;